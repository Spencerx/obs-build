
ExpandFlags: preinstallexpand

Preinstall: rpm
Preinstall: perl-interpreter perl-Digest-MD5 perl-POSIX
VMinstall: device-mapper iptables-libs

#AL specials:
Prefer: -openssl-snapsafe-libs
Prefer: gnupg2-minimal
Ignore: system-release:amazon-linux-repo(2023)

Order: filesystem:glibc
Order: filesystem:vim-filesystem
Order: filesystem:emacs-filesystem
Order: filesystem:acl
Order: filesystem:attr
Order: filesystem:libgcc
Order: filesystem:setup

# for osc local builds only
Substitute: obs:cli_debug_packages gdb vim strace

Substitute: mock:chroot_setup_cmd install bash bzip2 coreutils cpio diffutils fedora-release findutils gawk gcc gcc-c++ grep gzip info make patch redhat-rpm-config rpm-build sed shadow-utils tar unzip util-linux which xz

%define amzn 2023

DistMacro: amzn 2023
DistMacro: amzn2023 1
DistMacro: al_ver 2023
DistMacro: fedora 34
DistMacro: fc34 1
DistMacro: dist .amzn2023
DistMacro: vendorzone amazon.
DistMacro: _vendor amazon
DistMacro: golang_arches x86_64 aarch64
DistMacro: java_arches x86_64 aarch64
DistMacro: valgrind_arches x86_64 aarch64
DistMacro: py3_dist(**) python3dist(%{**})
DistMacro: python3_pkgversion 3
DistMacro: _bindir /usr/bin
DistMacro: _sbindir /usr/sbin

FileProvides: /usr/sbin/alternatives alternatives
FileProvides: /usr/sbin/update-alternatives alternatives
FileProvides: /usr/bin/fipscheck  fipscheck
FileProvides: /usr/bin/db_stat    libdb-utils
FileProvides: /usr/bin/gdb-add-index gdb-minimal
FileProvides: /usr/bin/gpg2 gnupg2
FileProvides: /usr/bin/ruby       rubypick
FileProvides: /usr/bin/python python-unversioned-command
FileProvides: /usr/bin/python2 python2
FileProvides: /usr/bin/python3 python3

FileProvides: /usr/bin/mailq esmtp
FileProvides: /usr/bin/uptime procps-ng
FileProvides: %{_sbindir}/fping fping

FileProvides: /usr/bin/git git-core
FileProvides: /usr/bin/hostname hostname
FileProvides: /usr/bin/envsubst gettext
FileProvides: /usr/sbin/ifconfig net-tools
FileProvides: /usr/bin/dtrace systemtap-sdt-dtrace
FileProvides: /usr/bin/awk gawk
FileProvides: /usr/bin/ssh openssh-clients
FileProvides: /usr/bin/ssh-add openssh-clients
FileProvides: /usr/bin/ssh-agent openssh-clients
FileProvides: /usr/bin/appstream-util libappstream-glib
FileProvides: /usr/bin/rst2man python3-docutils
FileProvides: /usr/bin/xsltproc libxslt
FileProvides: /usr/bin/gcc gcc
FileProvides: /usr/bin/pkg-config pkgconf-pkg-config
FileProvides: /usr/bin/objcopy binutils
FileProvides: /usr/bin/readelf binutils
FileProvides: /usr/bin/ps procps-ng
FileProvides: /usr/bin/g-ir-scanner gobject-introspection-devel

Substitute: javapackages-tools java-17-amazon-corretto-headless java-17-amazon-corretto-devel
Prefer: java-17-amazon-corretto-devel
Prefer: selinux-policy-minimum


Required: autoconf automake binutils bzip2 gcc gdbm gettext glibc
Required: libtool ncurses nss-softokn-freebl perl rpm zlib rpm-build

Ignore: glibc:glibc-langpack
Ignore: httpd:system-logos-httpd

Prefer: util-linux-core
Prefer: -compat-lua
Prefer: -java-11-openjdk-slowdebug
Prefer: fontconfig:bitmap-console-fonts

#
# Defined as minimum requires by Fedora
# http://fedoraproject.org/wiki/Packaging:Guidelines#PreReq
#
Required: gcc-c++

Support: bind-libs bind-utils bison cpp cracklib cvs cpio
Support: e2fsprogs file findutils flex gawk gdbm-devel gettext-devel
Support: glibc-devel gpm groff gzip info less
Support: make man-db kmod which
Support: ncurses-devel net-tools openssl
Support: patch procps psmisc strace
Support: texinfo unzip util-linux zlib-devel vim-enhanced
Support: initscripts bzip2-devel shadow-utils
Support: redhat-rpm-config perl-Digest-MD5 perl-POSIX

Prefer: -fedora-release generic-release:generic-release-nonproduct
Prefer: generic-release
Prefer: -coreutils-single -libcrypt-nss -compat-openssl10-devel
Prefer: libcurl-minimal curl-minimal
Prefer: libwayland-egl
Prefer: libusb1-devel
Prefer: libusb1
Prefer: openexr-devel

# Temporary workaround:
Prefer: -boost169-regex
